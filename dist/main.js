(()=>{function d(r,t,s=JSON.parse,i=JSON.stringify){let[l,n]=React.useState(()=>{try{let e=window.localStorage.getItem(r);return e?s(e):t}catch(e){return console.log(e),t}});return[l,e=>{try{let a=e instanceof Function?e(l):e;n(a),window.localStorage.setItem(r,i(a))}catch(a){console.log(a)}}]}var p={pending:"pending",rejected:"rejected",resolved:"resolved"},g={error:void 0,result:void 0,state:p.pending};function u(){let[r,t]=d("playbackrate.playbackspeed",1);return React.useEffect(()=>{loadedPlugins.LibFrontendPlay.currentAudioPlayer&&(loadedPlugins.LibFrontendPlay.currentAudioPlayer.playbackRate=r)},[r]),h("div",null,h("div",{style:{fontSize:"20px",color:"#ffffffaa",fontWeight:"800",marginBottom:"20px"}},"\u64AD\u653E\u8BBE\u7F6E"),h("label",{htmlFor:"album-size",className:"pbr-slider-label"},"\u500D\u901F/\u6162\u653E",r===1?void 0:h("button",{className:"rnp-slider-reset",onClick:()=>t(1)})),h("div",null,h("input",{type:"range",onChange:s=>{t(parseFloat(s.target.value))},className:"pbr-slider",min:.1,max:2.5,step:.01,value:r})))}plugin.onAllPluginsLoaded(function(){(async()=>{let r=await betterncm.utils.waitForElement(".spk.f-vc.f-cp.j-vol"),t=r.cloneNode(!0);t.querySelector("use").setAttribute("xlink:href","orpheus://orpheus/style/res/svg/topbar.sp.svg#set"),t.classList.add("playbackrate-settings");let s=[...document.querySelector("#main-player").children].filter(e=>e.getBoundingClientRect().height===24).sort((e,a)=>e.getBoundingClientRect().x-a.getBoundingClientRect().x),i=s.map((e,a)=>{let c=e.getBoundingClientRect().x-s[a-1]?.getBoundingClientRect().x;return isNaN(c)?[0,e]:[c,e]}).sort((e,a)=>a[0]-e[0]);t.style.right=`${i[0][1].getBoundingClientRect().x-t.getBoundingClientRect().width-10}px`,r.parentElement.appendChild(t);let l=document.createElement("style");l.innerHTML=await betterncm.fs.readFileText(this.pluginPath+"/style.css"),document.head.prepend(l),loadedPlugins.LibFrontendPlay.addEventListener("updateCurrentAudioPlayer",e=>{e.detail.playbackRate=JSON.parse(localStorage["playbackrate.playbackspeed"])});let n=document.createElement("div");ReactDOM.render(h(u,null),n),document.body.appendChild(n),n.classList.add("playbackrate-settings-popup"),n.style.pointerEvents="none";let o=!1;t.addEventListener("click",e=>{o?(o=!1,n.style.opacity="0",n.style.pointerEvents="none",n.style.transform="translateY(10px)"):(o=!0,n.style.display="block",n.style.bottom=`${document.body.clientHeight-t.getBoundingClientRect().top}px`,n.style.right=`${document.body.clientWidth-t.getBoundingClientRect().left-t.clientWidth}px`,n.style.opacity="1",n.style.transform="translateY(0px)",n.style.pointerEvents="")})})()});})();
